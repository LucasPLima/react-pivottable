{"version":3,"sources":["../../src/__tests__/Utilities-test.js"],"names":["utils","fixtureData","describe","aoaInput","pd","PivotData","data","it","expect","getAggregator","value","toBe","aggregatorName","vals","aosInput","a","b","raggedAosInput","functionInput","record","rows","cols","getRowKeys","toEqual","getColKeys","numNotNull","numNull","Array","from","r","c","records","forEachMatchingRecord","gender","push","x","name","agg","val","format","getVal","aggregators","tpl","aggregatorTemplates","count","countUnique","listUnique","average","sum","min","max","first","last","median","quantile","var","stdev","sumOverSum","fractionOf","naturalSort","sortedArr","NaN","Infinity","slice","sort","sortAs","numberFormat","nf","scaler","suffix","thousandsSep","decimalSep","prefix","digitsAfterDecimal","df","derivers","dateFormat","Date","binner","bin","toBeNaN"],"mappings":"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","file":"Utilities-test.js","sourcesContent":["import * as utils from '../Utilities';\r\n/* eslint-disable no-magic-numbers */\r\n\r\n/*\r\n * decaffeinate suggestions:\r\n * DS101: Remove unnecessary use of Array.from\r\n * DS102: Remove unnecessary code created because of implicit returns\r\n * DS207: Consider shorter variations of null checks\r\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\r\n */\r\nconst fixtureData = [\r\n  ['name', 'gender', 'colour', 'birthday', 'trials', 'successes'],\r\n  ['Nick', 'male', 'blue', '1982-11-07', 103, 12],\r\n  ['Jane', 'female', 'red', '1982-11-08', 95, 25],\r\n  ['John', 'male', 'blue', '1982-12-08', 112, 30],\r\n  ['Carol', 'female', 'yellow', '1983-12-08', 102, 14],\r\n];\r\n\r\ndescribe('  utils', function() {\r\n  describe('.PivotData()', function() {\r\n    describe('with no options', function() {\r\n      const aoaInput = [['a', 'b'], [1, 2], [3, 4]];\r\n      const pd = new utils.PivotData({data: aoaInput});\r\n\r\n      it('has the correct grand total value', () =>\r\n        expect(pd.getAggregator([], []).value()).toBe(2));\r\n    });\r\n\r\n    describe('with array-of-array input', function() {\r\n      const aoaInput = [['a', 'b'], [1, 2], [3, 4]];\r\n      const pd = new utils.PivotData({\r\n        data: aoaInput,\r\n        aggregatorName: 'Sum over Sum',\r\n        vals: ['a', 'b'],\r\n      });\r\n\r\n      it('has the correct grand total value', () =>\r\n        expect(pd.getAggregator([], []).value()).toBe((1 + 3) / (2 + 4)));\r\n    });\r\n\r\n    describe('with array-of-object input', function() {\r\n      const aosInput = [{a: 1, b: 2}, {a: 3, b: 4}];\r\n      const pd = new utils.PivotData({\r\n        data: aosInput,\r\n        aggregatorName: 'Sum over Sum',\r\n        vals: ['a', 'b'],\r\n      });\r\n\r\n      it('has the correct grand total value', () =>\r\n        expect(pd.getAggregator([], []).value()).toBe((1 + 3) / (2 + 4)));\r\n    });\r\n\r\n    describe('with ragged array-of-object input', function() {\r\n      const raggedAosInput = [{a: 1}, {b: 4}, {a: 3, b: 2}];\r\n      const pd = new utils.PivotData({\r\n        data: raggedAosInput,\r\n        aggregatorName: 'Sum over Sum',\r\n        vals: ['a', 'b'],\r\n      });\r\n\r\n      it('has the correct grand total value', () =>\r\n        expect(pd.getAggregator([], []).value()).toBe((1 + 3) / (2 + 4)));\r\n    });\r\n\r\n    describe('with function input', function() {\r\n      const functionInput = function(record) {\r\n        record({a: 1, b: 2});\r\n        record({a: 3, b: 4});\r\n      };\r\n      const pd = new utils.PivotData({\r\n        data: functionInput,\r\n        aggregatorName: 'Sum over Sum',\r\n        vals: ['a', 'b'],\r\n      });\r\n\r\n      it('has the correct grand total value', () =>\r\n        expect(pd.getAggregator([], []).value()).toBe((1 + 3) / (2 + 4)));\r\n    });\r\n\r\n    describe('with rows/cols', function() {\r\n      const pd = new utils.PivotData({\r\n        data: fixtureData,\r\n        rows: ['name', 'colour'],\r\n        cols: ['trials', 'successes'],\r\n      });\r\n\r\n      it('has correctly-ordered row keys', () =>\r\n        expect(pd.getRowKeys()).toEqual([\r\n          ['Carol', 'yellow'],\r\n          ['Jane', 'red'],\r\n          ['John', 'blue'],\r\n          ['Nick', 'blue'],\r\n        ]));\r\n\r\n      it('has correctly-ordered col keys', () =>\r\n        expect(pd.getColKeys()).toEqual([\r\n          [95, 25],\r\n          [102, 14],\r\n          [103, 12],\r\n          [112, 30],\r\n        ]));\r\n\r\n      it('can be iterated over', function() {\r\n        let numNotNull = 0;\r\n        let numNull = 0;\r\n        for (const r of Array.from(pd.getRowKeys())) {\r\n          for (const c of Array.from(pd.getColKeys())) {\r\n            if (pd.getAggregator(r, c).value() !== null) {\r\n              numNotNull++;\r\n            } else {\r\n              numNull++;\r\n            }\r\n          }\r\n        }\r\n        expect(numNotNull).toBe(4);\r\n        expect(numNull).toBe(12);\r\n      });\r\n\r\n      it('returns matching records', function() {\r\n        const records = [];\r\n        pd.forEachMatchingRecord({gender: 'male'}, x => records.push(x.name));\r\n        expect(records).toEqual(['Nick', 'John']);\r\n      });\r\n\r\n      it('has a correct spot-checked aggregator', function() {\r\n        const agg = pd.getAggregator(['Carol', 'yellow'], [102, 14]);\r\n        const val = agg.value();\r\n        expect(val).toBe(1);\r\n        expect(agg.format(val)).toBe('1');\r\n      });\r\n\r\n      it('has a correct grand total aggregator', function() {\r\n        const agg = pd.getAggregator([], []);\r\n        const val = agg.value();\r\n        expect(val).toBe(4);\r\n        expect(agg.format(val)).toBe('4');\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('.aggregatorTemplates', function() {\r\n    const getVal = (agg, vals) => {\r\n      return new utils.PivotData({\r\n        data: fixtureData,\r\n        aggregators: {agg},\r\n        aggregatorName: 'agg',\r\n        vals,\r\n      })\r\n        .getAggregator([], [])\r\n        .value();\r\n    };\r\n    const tpl = utils.aggregatorTemplates;\r\n\r\n    describe('.count', () =>\r\n      it('works', () => expect(getVal(tpl.count(), [])).toBe(4)));\r\n\r\n    describe('.countUnique', () =>\r\n      it('works', () => expect(getVal(tpl.countUnique(), ['gender'])).toBe(2)));\r\n\r\n    describe('.listUnique', () =>\r\n      it('works', () =>\r\n        expect(getVal(tpl.listUnique(), ['gender'])).toBe('male,female')));\r\n\r\n    describe('.average', () =>\r\n      it('works', () => expect(getVal(tpl.average(), ['trials'])).toBe(103)));\r\n\r\n    describe('.sum', () =>\r\n      it('works', () => expect(getVal(tpl.sum(), ['trials'])).toBe(412)));\r\n\r\n    describe('.min', () =>\r\n      it('works', () => expect(getVal(tpl.min(), ['trials'])).toBe(95)));\r\n\r\n    describe('.max', () =>\r\n      it('works', () => expect(getVal(tpl.max(), ['trials'])).toBe(112)));\r\n\r\n    describe('.first', () =>\r\n      it('works', () => expect(getVal(tpl.first(), ['name'])).toBe('Carol')));\r\n\r\n    describe('.last', () =>\r\n      it('works', () => expect(getVal(tpl.last(), ['name'])).toBe('Nick')));\r\n\r\n    describe('.average', () =>\r\n      it('works', () => expect(getVal(tpl.average(), ['trials'])).toBe(103)));\r\n\r\n    describe('.median', () =>\r\n      it('works', () => expect(getVal(tpl.median(), ['trials'])).toBe(102.5)));\r\n\r\n    describe('.quantile', () =>\r\n      it('works', function() {\r\n        expect(getVal(tpl.quantile(0), ['trials'])).toBe(95);\r\n        expect(getVal(tpl.quantile(0.1), ['trials'])).toBe(98.5);\r\n        expect(getVal(tpl.quantile(0.25), ['trials'])).toBe(98.5);\r\n        expect(getVal(tpl.quantile(1 / 3), ['trials'])).toBe(102);\r\n        expect(getVal(tpl.quantile(1), ['trials'])).toBe(112);\r\n      }));\r\n\r\n    describe('.var', () =>\r\n      it('works', () =>\r\n        expect(getVal(tpl.var(), ['trials'])).toBe(48.666666666666686)));\r\n\r\n    describe('.stdev', () =>\r\n      it('works', () =>\r\n        expect(getVal(tpl.stdev(), ['trials'])).toBe(6.976149845485451)));\r\n\r\n    describe('.sumOverSum', () =>\r\n      it('works', () =>\r\n        expect(getVal(tpl.sumOverSum(), ['successes', 'trials'])).toBe(\r\n          (12 + 25 + 30 + 14) / (95 + 102 + 103 + 112)\r\n        )));\r\n\r\n    describe('.fractionOf', () =>\r\n      it('works', () =>\r\n        expect(getVal(tpl.fractionOf(tpl.sum()), ['trials'])).toBe(1)));\r\n  });\r\n\r\n  describe('.naturalSort()', function() {\r\n    const {naturalSort} = utils;\r\n\r\n    const sortedArr = [\r\n      null,\r\n      NaN,\r\n      -Infinity,\r\n      '-Infinity',\r\n      -3,\r\n      '-3',\r\n      -2,\r\n      '-2',\r\n      -1,\r\n      '-1',\r\n      0,\r\n      '2e-1',\r\n      1,\r\n      '01',\r\n      '1',\r\n      2,\r\n      '002',\r\n      '002e0',\r\n      '02',\r\n      '2',\r\n      '2e-0',\r\n      3,\r\n      10,\r\n      '10',\r\n      '11',\r\n      '12',\r\n      '1e2',\r\n      '112',\r\n      Infinity,\r\n      'Infinity',\r\n      '1a',\r\n      '2a',\r\n      '12a',\r\n      '20a',\r\n      'A',\r\n      'A',\r\n      'NaN',\r\n      'a',\r\n      'a',\r\n      'a01',\r\n      'a012',\r\n      'a02',\r\n      'a1',\r\n      'a2',\r\n      'a12',\r\n      'a12',\r\n      'a21',\r\n      'a21',\r\n      'b',\r\n      'c',\r\n      'd',\r\n      'null',\r\n    ];\r\n\r\n    it('sorts naturally (null, NaN, numbers & numbery strings, Alphanum for text strings)', () =>\r\n      expect(sortedArr.slice().sort(naturalSort)).toEqual(sortedArr));\r\n  });\r\n\r\n  describe('.sortAs()', function() {\r\n    const {sortAs} = utils;\r\n\r\n    it('sorts with unknown values sorted at the end', () =>\r\n      expect([5, 2, 3, 4, 1].sort(sortAs([4, 3, 2]))).toEqual([4, 3, 2, 1, 5]));\r\n\r\n    it('sorts lowercase after uppercase', () =>\r\n      expect(['Ab', 'aA', 'aa', 'ab'].sort(sortAs(['Ab', 'Aa']))).toEqual([\r\n        'Ab',\r\n        'ab',\r\n        'aa',\r\n        'aA',\r\n      ]));\r\n  });\r\n\r\n  describe('.numberFormat()', function() {\r\n    const {numberFormat} = utils;\r\n\r\n    it('formats numbers', function() {\r\n      const nf = numberFormat();\r\n      expect(nf(1234567.89123456)).toEqual('1,234,567.89');\r\n    });\r\n\r\n    it('formats booleans', function() {\r\n      const nf = numberFormat();\r\n      expect(nf(true)).toEqual('1.00');\r\n    });\r\n\r\n    it('formats numbers in strings', function() {\r\n      const nf = numberFormat();\r\n      expect(nf('1234567.89123456')).toEqual('1,234,567.89');\r\n    });\r\n\r\n    it(\"doesn't formats strings\", function() {\r\n      const nf = numberFormat();\r\n      expect(nf('hi there')).toEqual('');\r\n    });\r\n\r\n    it(\"doesn't formats objects\", function() {\r\n      const nf = numberFormat();\r\n      expect(nf({a: 1})).toEqual('');\r\n    });\r\n\r\n    it('formats percentages', function() {\r\n      const nf = numberFormat({scaler: 100, suffix: '%'});\r\n      expect(nf(0.12345)).toEqual('12.35%');\r\n    });\r\n\r\n    it('adds separators', function() {\r\n      const nf = numberFormat({thousandsSep: 'a', decimalSep: 'b'});\r\n      expect(nf(1234567.89123456)).toEqual('1a234a567b89');\r\n    });\r\n\r\n    it('adds prefixes and suffixes', function() {\r\n      const nf = numberFormat({prefix: 'a', suffix: 'b'});\r\n      expect(nf(1234567.89123456)).toEqual('a1,234,567.89b');\r\n    });\r\n\r\n    it('scales and rounds', function() {\r\n      const nf = numberFormat({digitsAfterDecimal: 3, scaler: 1000});\r\n      expect(nf(1234567.89123456)).toEqual('1,234,567,891.235');\r\n    });\r\n  });\r\n\r\n  describe('.derivers', function() {\r\n    describe('.dateFormat()', function() {\r\n      const df = utils.derivers.dateFormat(\r\n        'x',\r\n        'abc % %% %%% %a %y %m %n %d %w %x %H %M %S',\r\n        true\r\n      );\r\n\r\n      it('formats date objects', () =>\r\n        expect(df({x: new Date('2015-01-02T23:43:11Z')})).toBe(\r\n          'abc % %% %%% %a 2015 01 Jan 02 Fri 5 23 43 11'\r\n        ));\r\n\r\n      it('formats input parsed by Date.parse()', function() {\r\n        expect(df({x: '2015-01-02T23:43:11Z'})).toBe(\r\n          'abc % %% %%% %a 2015 01 Jan 02 Fri 5 23 43 11'\r\n        );\r\n\r\n        expect(df({x: 'bla'})).toBe('');\r\n      });\r\n    });\r\n\r\n    describe('.bin()', function() {\r\n      const binner = utils.derivers.bin('x', 10);\r\n\r\n      it('bins numbers', function() {\r\n        expect(binner({x: 11})).toBe(10);\r\n\r\n        expect(binner({x: 9})).toBe(0);\r\n\r\n        expect(binner({x: 111})).toBe(110);\r\n      });\r\n\r\n      it('bins booleans', () => expect(binner({x: true})).toBe(0));\r\n\r\n      it('bins negative numbers', () => expect(binner({x: -12})).toBe(-10));\r\n\r\n      it(\"doesn't bin strings\", () => expect(binner({x: 'a'})).toBeNaN());\r\n\r\n      it(\"doesn't bin objects\", () => expect(binner({x: {a: 1}})).toBeNaN());\r\n    });\r\n  });\r\n});\r\n"]}